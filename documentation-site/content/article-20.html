<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <title>HTML5 Video Player - Eagle Eye Networks API</title>
    <style>

        .preview_img {
            width: 320px;
            height: 180px;
        }

        img {
            width: 100%;
            border: grey solid thin;
        }

        body {
            padding-top: 5rem;
        }

        .starter-template {
            padding: 3rem 1.5rem;
            text-align: center;
        }

        .row {
            padding-top: 10px;
            padding-bottom: 20px;
        }

        h2 {
            border-bottom: thick linen solid;
        }

        table {
            width: 100%;
        }

        input {
            width:350px;
        }


    </style>
</head>
<body>
<main role="main" class="container-fluid">
    <div class="container-fluid">
        <div class="row" id="camera_holder"></div>

        <div class="row">
            <div class="col-9 offset-1">
	    	<h1>HTML5 Video Player</h1>
            </div>
        </div>


        <div class="row">
            <div class="col-9 offset-1">
                <p>
                    I am very excited to be demonstrating how to use the Eagle Eye Video API with the standard HTML5 Video Player.  No longer requiring a flash player, or transcoding the video, is a large improvement in user experience.  It is also faster and a more streamlined way to use our API.
                </p>
                <p>
                    We are providing this same JavaScript component to be used for websites that want to play video natively.  You can access the code <a href="https://github.com/EENCloud/API-Documentation/tree/master/EEN.MediaPlayer">on Github</a>.  You can use the forms below to test the player.
                </p>
            </div>
        </div>
        <div class="row">
            <div class="col-11 offset-1">
                <h2>How do I get started?</h2>
            </div>
        </div>

        <div class="row">
            <div class="col-7 offset-1">
                <p>
                    We have already been using the HTML5 video player for video playback inside of the Eagle Eye VMS.  It has been the default option since the second half of 2019.  If you are embedding or linking to the video player page/history browser than you already have been using the HTML5 video player.
                </P>
                <p>
                    Please supply a valid ESN and an auth_key that has access to view the video.
                </p>
                <p>
                <table>
                    <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Value</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>ESN</td>
                        <td><input type="text" placeholder="Camera ESN" maxlength="8" style="form-control" id="1_esn"></td>
                    </tr>
                    <tr>
                        <td>Start Timestamp</td>
                        <td> <input type="text" placeholder="Start timestamp" maxlength="18" style="form-control" id="1_start_timestamp" value="stream_een.cloud_demo"></td>
                    </tr>
                    <tr>
                        <td>End Timestamp</td>
                        <td><input type="text" placeholder="End timestamp" maxlength="18" style="form-control" id="1_end_timestamp" value="+30000"></td>
                    </tr>
                    <tr>
                        <td>Auth Key</td>
                        <td> <input type="text" placeholder="Auth Key" maxlength="37" style="form-control" id="1_auth_key"></td>
                    </tr>
                    </tbody>
                </table>
                <br>
                <button class="btn btn-primary" id="load_live_button">load live video</button>
                </p>
            </div>
            <div class="col-4">
                <video id="videoElement_live" style="width: 100%; height:100%;" controls></video>
            </div>
        </div>

        <div class="row">
            <div class="col-11 offset-1">
                <h2>Does this work for live and historic video?</h2>
            </div>
        </div>
        <div class="row">
            <div class="col-7 offset-1">
                <p>
                    Yes.  From the the Eagle Eye API, the only difference between live and historic video is the time that it should start playing the video.  There are more differences under the hood, but from the perspective of calling the API, you request live video using a stream_id and a time_offset.  The stream_id replaces the start_timestamp parameter and the time_offset parameter replaces the end_timestamp.
                </p>
                <p>
                    Live and historic video is retrieved using the following <a href="https://apidocs.eagleeyenetworks.com/apidocs/#get-video">API call</a>.
                </p>
                <p>
                <table>
                    <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Value</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>ESN</td>
                        <td><input type="text" placeholder="Camera ESN" maxlength="8" style="form-control" id="2_esn"></td>
                    </tr>
                    <tr>
                        <td>Start Timestamp</td>
                        <td> <input type="text" placeholder="Start timestamp" maxlength="18" style="form-control" id="2_start_timestamp"></td>
                    </tr>
                    <tr>
                        <td>End Timestamp</td>
                        <td><input type="text" placeholder="End timestamp" maxlength="18" style="form-control" id="2_end_timestamp"></td>
                    </tr>
                    <tr>
                        <td>Auth Key</td>
                        <td> <input type="text" placeholder="Auth Key" maxlength="37" style="form-control" id="2_auth_key"></td>
                    </tr>
                    </tbody>
                </table>
                <br>
                <button class="btn btn-primary" id="load_hist_button">load historic video</button>
            </div>
            <div class="col-4">
                <video id="videoElement_hist" style="width: 100%; height:100%;" controls></video>
            </div>
        </div>


        <div class="row">
            <div class="col-11 offset-1">
                <h2>What about CORS?</h2>
            </div>
        </div>
        <div class="row">
            <div class="col-8 offset-1">
                <p>
                    CORS is a browser security feature that establishes rules for Cross Origin Requests.  It is implemented in all modern web browsers and requires that the remote site allows cross origin requests to specific resources.  We implement a whitelist system that allows us to block all requests except for known technology partners.  Please reach out to me at mcotton@een.com to get your domain whitelisted.
                </p>
                <p>
                    Please note that invalid reqeusts that would normaly result in a 400 response will return a CORS error.  Please confirm that paramters that you are sending if you are on a whitelisted domain and still have problems.
                </p>
            </div>
            <div class="col-3">
            </div>
        </div>


        <div class="row">
            <div class="col-11 offset-1">
                <h2>Does this mean no more FLV?</h2>
            </div>
        </div>
        <div class="row">
            <div class="col-8 offset-1">
                <p>
                    The FLV file format is a great, simple, straightforward container for h.264 video and we intend to continue using it.  It allows us to slice and concatinate video as needed.  Most importantly is a streamable format and is well supported among video players.  Other than Flash players in browsers, it is an ideal format.
                </p>
            </div>
            <div class="col-3">
            </div>
        </div>

        <div class="row">
            <div class="col-11 offset-1">
                <h2>What else can we do with this?</h2>
            </div>
        </div>
        <div class="row">
            <div class="col-9 offset-1">
                <p>
                    I am excited the see the additional applications that can benefit from easily embeddable video.  Not only can the preview stream be worked as a series of JPEG images, video can now be used as just a standard video component.
                </p>
                <p>
                    I hope you found this helpful.  If you have any questions please feel free to reach out to us at api_support@een.com
                </p>

            </div>

        </div>

    </div>

</main>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<script src="EEN.MediaPlayer.js"></script>
<script>

    $(document).ready(function() {

        var flvjs = EEN.MediaPlayer.flvjs;

        $("#load_live_button").click(function() {
            if (flvjs.isSupported()) {
                var videoElementLive = document.getElementById('videoElement_live');
                var config = new EEN.MediaPlayer.MediaItem($('#1_esn').val());
                config.setAuthKey($('#1_auth_key').val())
                config.setDomain('login.eagleeyenetworks.com')
                config.setStartTime($('#1_start_timestamp').val())
                config.setEndTime($('#1_end_timestamp').val())
                EEN.MediaPlayer.startPlayback(config, videoElementLive);
            }
        })

        $("#load_hist_button").click(function() {
            if (flvjs.isSupported()) {
                var videoElementHist = document.getElementById('videoElement_hist');
                var config = new EEN.MediaPlayer.MediaItem($('#2_esn').val());
                config.setDomain('login.eagleeyenetworks.com')
                config.setAuthKey($('#2_auth_key').val())
                config.setStartTime($('#2_start_timestamp').val())
                config.setEndTime($('#2_end_timestamp').val())
                EEN.MediaPlayer.startPlayback(config, videoElementHist);

            }
        })

    });


</script>

</body>
</html>

