<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <title>Recognizing QR Codes in Video - Eagle Eye Networks API</title>
    <style>
        
        .preview_img {
            width: 320px;
            height: 180px;
        }

        img {
            width: 100%;
            border: grey solid thin;
        }

        body {
          padding-top: 5rem;
        }

        .starter-template {
          padding: 3rem 1.5rem;
          text-align: center;
        }

        .row {
            padding-top: 10px;
            padding-bottom: 20px;
        }

        h2 {
            border-bottom: thick linen solid;
        }


    </style>
</head>
<body>
    <main role="main" class="container">
        <div class="container">
            <div class="row" id="camera_holder"></div>

            <div class="row">
                <div class="col-9 offset-1">
                    <h1>Recognizing QR Codes in Video</h1>
                </div>
            </div>


            <div class="row">
                <div class="col-9 offset-1">
                    <p>
                        <video controls style="width:100%; height:500px; min-height:400px;">
                            <source src="images/article-21-video-1.mp4" type="video/mp4">
                        </video>
                        <!--  <iframe style="width:100%; height:500px; min-height:400px;" src="https://www.youtube.com/embed/dQq4EPSQkS0" frameborder="0" allow="accelerometer; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe> -->
                    </p>
                    <p>
                        Barcodes and QR codes are all around us.  They are great ways to encode information into an easily recognizable design.  This article will go through the process of tracking and reading QR codes from the Eagle Eye Networks Video API.  This is a complete end-to-end example from generation through tracking across multiple detections.
                    </p>
                </div>
            </div>
            <div class="row">
                <div class="col-11 offset-1">
                    <h2>Step 1: Setup and Required Components</h2>
                </div>
            </div>

            <div class="row">
                <div class="col-8 offset-1">       
                   <p>
                       In the above video we are using a 2MP camera connected to the Eagle Eye VMS through a bridge (BR304).  The specifics of the camera only matter to the point that the resolution and focal length provide an acceptable view of the work surface.  In a latter step we will look at the required resolution needed for accurate detection.
                    </P>
                    <p>
                        The example is being run from a laptop to simplify the demonstration.  There is nothing that requires this to be running at the edge instead of the cloud.  The computation requirements are moderate so there is no need for high performance equipment.  I would expect this could run on anything from a Raspberry Pi to a small cloud instance from your favorite provider.
                    </p>
                </div>
                <div class="col-3"></div>
            </div>

            <div class="row">
                <div class="col-11 offset-1">
                    <h2>Step 2: Accessing the Video Stream</h2>
                </div>
            </div>
            <div class="row">
                <div class="col-8 offset-1">
                    <p>
                        The starting process is to <a href="https://apidocs.eagleeyenetworks.com/apidocs/#1-authenticate">Authenticate</a> and <a href="https://apidocs.eagleeyenetworks.com/apidocs/#3-authorize">Authorize</a> through the API.  In the above example the credentails are passed from the user directly through to the API.  This is a valid use for an example but it is strongly recommened that a separate user management system would be included before use.  
                    </p>
                    <p>
                        If you are processing video on the same network as the video source you can get the local <a href="https://apidocs.eagleeyenetworks.com/apidocs/#get-cameras-rtsp-urls">RTSP setings using this call</a>.
                    </p>
                    <p>
                        If you are processing the video remotely you can retrieve the video using the <a href="https://apidocs.eagleeyenetworks.com/apidocs/#get-video">Get Video endpoint</a>.  This endpoint will retrieve live and/or historic video.
                    </p>
                </div>
                <div class="col-3"></div>
            </div>


            <div class="row">
                <div class="col-11 offset-1">
                    <h2>Step 3: Processing the Video Stream</h2>
                </div>
            </div>
            <div class="row">
                <div class="col-8 offset-1">
                    <p>
                        When the video stream has been established, the next step is to process each frame looking for QR codes.  The very popular open-source library <a href="http://zbar.sourceforge.net/">ZBar</a> is avialble to detect and parse the actual data.  Using the appropriate laguage bindinds it makes it easy to incorporate this functionality.
                    </p>
                    <p>
                        It is worth noting that even less computational resources are required if it is run through a GStreamer pipeline instead of parsing the video and processing it through OpenCV.  Looking at each frame individually simplifies the example significantly but leaves plenty of room for optimizations when actually implemented.
                    </p>
                    <p>
                        Each time a QR code is detected, the decoded text, metadata, time,  and the location in the frame should be recorded in the database.  The web front end is driven by the data in the database and can be refreshed to show the latest information.
                    </p>
                    <p>
                        The same QR code may appear on the same video stream in subsequent frames or it may appear in another video stream.  The purpose of tracking the data in a dabatase is to allow the users to query the information and get results across video streams.
                    </p>
                    <p>
                        The last step shown is to <a href="article-3.html">link to the History Browser</a> so that the user can see the video of the detection at the correct point in time.
                    </p>
                </div>
                <div class="col-3">
                </div>
            </div>


            <div class="row">
                <div class="col-11 offset-1">
                    <h2>Step 4: Annotating the Video Stream</h2>
                </div>
            </div>
            <div class="row">
                <div class="col-8 offset-1">
                    <p>
                       Multiple QR codes may be detected in the video at the same time.  Unlike computers, humans generally have a hard time distinquishing QR codes from video.  I recommend annotating the video and drawing a bounding box around the detected QR code.  This is being done in the above video with a red box along with the label.
                    </p>
                    <p>
                        Drawing on the video directly is instructive in the above example but it may not be appropiate to obscure so much of the video in a production environment.  Placing annotations on the history browser allows the user to understand what was detected and where it is on screen.  The display of annotations can be turned off on a per-user basis.
                    </p>
                    <p>
                        You can see the annotation inside the Eagle Eye History Browser in the above video.  For more details please refer to the <a href="article-14.html"> previous article on cloud annotations</a>. 
                    </p>
                </div>
                <div class="col-3">
                </div>
            </div>

            <div class="row">
                <div class="col-11 offset-1">
                    <h2>What else can we do with this?</h2>
                </div>
            </div>
            <div class="row">
                <div class="col-9 offset-1">
                    <p>
                        I hope that I have shown you something new and given you an idea of something else that can be done with the Eagle Eye Networks VIdeo API.  If you have any questions please feel free to reach out to us at api_support@een.com
                    </p>
                
                </div>

            </div>
            
        </div>

    </main>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

</body>
</html>
